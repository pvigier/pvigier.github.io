
	







<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="Pierre Vigier">

        <title>Blog - pvigier's blog</title>
        <link rel="shortcut icon" href="/media/img/favicon.png">
        <!-- Bootstrap -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <!-- My themes -->
        <link href="/media/css/style.css" rel="stylesheet">
        <link href="/media/css/syntax.css" rel="stylesheet">
        <link href="/media/css/modal.css" rel="stylesheet">
    </head>
    <body>
        <div class="blog-masthead">
            <div class="container">
                <nav class="blog-nav">
                    <a class="blog-nav-item active" href="/">Blog</a>
                    <a class="blog-nav-item" href="/articles">Articles</a>
                    <a class="blog-nav-item" href="/games">Games</a>
                    <!--<a class="blog-nav-item" href="/best-resources">Best Resources</a>-->
                    <a class="blog-nav-item" href="/resume">Resume</a>
                    <a class="blog-nav-item" href="/about">About</a>
                </nav>
            </div>
        </div>
        <div class="container">
            <div class="blog-header">
                <h1 class="blog-title">pvigier's blog</h1>
                <p class="lead blog-description">computer science, programming and other ideas</p>
            </div>
            <div class="row">
            <div class="col-sm-8 blog-main">

    <div class="blog-post">
        <h2 class="blog-post-title">Terrain generation in Simulopolis</h2>
        <p class="blog-post-meta">08 Oct 2018 by <a href="/">pierre</a></p>
        <p>Hi!</p>

<p>Today I will describe the generator of terrains I made for Simulopolis.</p>

<p>Here are some screenshots of terrains from the game.</p>

<p><img src="/media/img/terrain-generation-simulopolis/terrain_pcg_gif.gif" alt="Cover" class="center-image modal-image" /></p>

<p>In this article, I will not describe the C++ code used in the game as it is verbose and unnecessarily complicated. Instead, I will use the Python code I used to design the generator.</p>

<p>Indeed, I found much more pleasant to use Python for prototyping as it is really fast to write something which works, there are good libraries and we do not have to wait for compilation every time we made a change. It is especially true for procedural content generation where we have to iterate a lot before obtaining something decent.</p>

<p>The code I will present is the exact translation in Python of what is currently implemented in the game. It is based on the implementation of Perlin noise I described previously in this <a href="/2018/06/13/perlin-noise-numpy.html">article</a>. As usual, you can find the whole project on <a href="https://github.com/pvigier/simulopolis-terrain-generator">github</a>.</p>


        <p><a href="/2018/10/08/terrain-generation-simulopolis.html">Read more ...</a></p>
    </div>
    <hr />

    <div class="blog-post">
        <h2 class="blog-post-title">Distributing a C++ program on Linux</h2>
        <p class="blog-post-meta">07 Oct 2018 by <a href="/">pierre</a></p>
        <p>Hi!</p>

<p>Today I will tackle a problem I faced when I wanted to distribute the alpha version of Simulopolis two weeks ago: distributing a C++ binary on different Linux distributions.</p>

<p>So two weeks ago, I was happy, I had a version of Simulopolis which ran smoothly on my laptop. And I thought it was time to share it with people to have some feedback. Very naively, I took the binary and the assets, put them on a new folder and uploaded the whole thing on itch.io.</p>

<p>Then, I sent a message to my big brother telling him that he can try my game. He downloaded the game and when he tried to run the game, he obtained this error message:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./Simulopolis: error while loading shared libraries: libboost_serialization.so.1.65.1: cannot open shared object file: No such file or directory
</code></pre></div></div>

<p>Uhh, this was not expected!</p>

<p><img src="https://media.giphy.com/media/U4VXRfcY3zxTi/giphy.gif" alt="Disappointed gif" class="center-image modal-image" /></p>

<p>We read the error message, it tells that a dependency I use to build the game is missing on my brother’s system. So he tried to install Boost Serialization, SFML and TinyXML the three libraries I use in Simulopolis. But that did not solve the problem because the program is looking for a specific version of the dependency (here the version 1.65.1 of Boost serialization). And as he was on a different Linux distribution, Fedora, than me, Ubuntu, it was not the same version of Boost Serialization that was available in its package manager.</p>


        <p><a href="/2018/10/07/distributing-c++-program-linux.html">Read more ...</a></p>
    </div>
    <hr />

    <div class="blog-post">
        <h2 class="blog-post-title">Simulopolis alpha is released</h2>
        <p class="blog-post-meta">06 Oct 2018 by <a href="/">pierre</a></p>
        <p><img src="/media/img/simulopolis-alpha-1/cover.png" alt="Cover" class="center-image modal-image" /></p>

<p>Today, I’m happy to announce you that the first release of my city building game, Simulopolis, is available online.</p>

<p>It’s been a long and chaotic journey which lasted a bit more than six months.</p>


        <p><a href="/2018/10/06/simulopolis-alpha-1.html">Read more ...</a></p>
    </div>
    <hr />

    <div class="blog-post">
        <h2 class="blog-post-title">Perlin noise with numpy</h2>
        <p class="blog-post-meta">13 Jun 2018 by <a href="/">pierre</a></p>
        <p>Hi everyone, I have written an implementation of Perlin noise with numpy that is pretty fast and I want to share it with you. The code is available <a href="https://github.com/pvigier/perlin-numpy">here</a>.</p>

<h1 id="perlin-noise">Perlin noise</h1>

<p>My code looks like the original implementation. The only difference is that I tried to use the vectorized operations of numpy as much as possible instead of <code class="highlighter-rouge">for</code> loops. Because as you may know, loops are really slow in Python.</p>

<p>Here is the code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">generate_perlin_noise_2d</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">res</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">15</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">3</span>
    
    <span class="n">delta</span> <span class="o">=</span> <span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">delta</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">:</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="n">delta</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span>
    <span class="c"># Gradients</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">gradients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angles</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angles</span><span class="p">)))</span>
    <span class="n">g00</span> <span class="o">=</span> <span class="n">gradients</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">g10</span> <span class="o">=</span> <span class="n">gradients</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">g01</span> <span class="o">=</span> <span class="n">gradients</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">g11</span> <span class="o">=</span> <span class="n">gradients</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c"># Ramps</span>
    <span class="n">n00</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">grid</span> <span class="o">*</span> <span class="n">g00</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">n10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="n">grid</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">grid</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]))</span> <span class="o">*</span> <span class="n">g10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">n01</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="n">grid</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">grid</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">g01</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">n11</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="n">grid</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">grid</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">g11</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="c"># Interpolation</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
    <span class="n">n0</span> <span class="o">=</span> <span class="n">n00</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">t</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">n10</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="n">n01</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">t</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">n11</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">n0</span> <span class="o">+</span> <span class="n">t</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">n1</span><span class="p">)</span>
</code></pre></div></div>

<p>If you are familiar with Perlin noise, nothing should surprise you. Otherwise, I can suggest you to read the first pages of this <a href="http://staffwww.itn.liu.se/~stegu/simplexnoise/simplexnoise.pdf">article</a> which explain Perlin noise very well in my opinion.</p>

<p>An example of what the function generates:</p>

<p><img src="https://raw.githubusercontent.com/pvigier/perlin-numpy/master/examples/perlin.png" alt="" /></p>

<p>I normalized the gradients so that the noise is always between -1 and 1.</p>


        <p><a href="/2018/06/13/perlin-noise-numpy.html">Read more ...</a></p>
    </div>
    <hr />

    <div class="blog-post">
        <h2 class="blog-post-title">Fractal Image Compression</h2>
        <p class="blog-post-meta">14 May 2018 by <a href="/">pierre</a></p>
        <p>One year ago, I coded a very simple implementation of fractal image compression for a course and I made the code available on github <a href="https://github.com/pvigier/fractal-image-compression">there</a>.</p>

<p>To my surprise, the repo is quite popular. So I decided to update the code and to write an article to explain the theory and the code.</p>


        <p><a href="/2018/05/14/fractal-image-compression.html">Read more ...</a></p>
    </div>
    <hr />

<nav>
    <ul class="pager">
        
        <li><span>Previous</span></li>
        
        
        <li><a href="/2/">Next</a></li>
        
    </ul>
</nav>


</div><!-- /.blog-main -->
<div class="col-sm-3 col-sm-offset-1 blog-sidebar">
    <div class="sidebar-module">
        <h4>Archives</h4>
        <ol class="list-unstyled">
        
            
            
            <li id="yOctober 2018"><a href="/2018/10">October 2018</a></li>
             
            
        
            
            
        
            
            
        
            
            
            <li id="yJune 2018"><a href="/2018/06">June 2018</a></li>
             
            
        
            
            
            <li id="yMay 2018"><a href="/2018/05">May 2018</a></li>
             
            
        
            
            
            <li id="yFebruary 2018"><a href="/2018/02">February 2018</a></li>
             
            
        
            
            
        
            
            
            <li id="yAugust 2017"><a href="/2017/08">August 2017</a></li>
             
            
        
            
            
            <li id="yJuly 2017"><a href="/2017/07">July 2017</a></li>
             
            
        
            
            
            <li id="yFebruary 2017"><a href="/2017/02">February 2017</a></li>
             
            
        
        </ol>
    </div>
    <div class="sidebar-module">
        <h4>Follow me</h4>
        <ol class="list-unstyled">
            <li><a href="https://github.com/pvigier">GitHub</a></li>
            <li><a href="https://twitter.com/PierreVigier">Twitter</a></li>
            <li><a href="/rss.xml">RSS</a></li>
        </ol>
    </div>
</div><!-- /.blog-sidebar -->
            </div><!-- /.row -->
        </div><!-- /.container -->

        <footer class="blog-footer">
            <p>Powered by <a href="http://getbootstrap.com">Bootstrap</a> and <a href="http://jekyllrb.com">Jekyll</a>.</p>
            <p>
                <a href="#">Back to top</a>
            </p>
        </footer>
        <!-- Javascript -->
        <!-- jQuery -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <!-- Bootstrap -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <!-- MathJax -->
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
        <!-- Analytics -->
        <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-30902264-4', 'auto');
        ga('send', 'pageview');
        </script>
        <!-- Modal images -->
        <script src="/media/js/modal.js"></script>
    </body>
</html>
